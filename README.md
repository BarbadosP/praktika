# praktika
Практика: Нейронная сеть (глубокая). Предсказать неизвестную переменную при помощи временных времен

Задача
Задача состоит в предсказании целевой переменной на основе имеющихся данных с учетом того, что данные распределены по времени (со всеми вытекающими из этого особенностями). В процессе работы необходимо использовать не менее двух метрик.
Если вам достался вариант с нейронной сетью (глубокая), то вы должны получить результат используя подходящую нейронную сеть, но не полносвязную. В ходе выполнения задания учебной практики необходимо объяснить (в отчете) почему вы выбрали ту или иную структуру нейронной сети. В вашем случае задача сводится к тому, можно ли так упростить ИНС чтобы она все-таки могла решить поставленную задачу.
Результаты обязательно визуализируются.
Искомая переменная P1


Дата-сет:

Date	P1	T		A	R	IN1	IN2	OUT

03.07.2017	19,241	22,3	46	0,9	0	0,00	19,69	0,00
04.07.2017	19,356	23,1	45	0,82	0	0,00	15,14	7,68
05.07.2017	19,982	23,0	46	0,74	0	0,00	0,00	10,00
06.07.2017	20,326	24,0	67	0,66	0	0,00	21,35	6,77
07.07.2017	20,255	24,0	46	0,58	0	0,00	0,00	12,43
08.07.2017	20,018	17,0	46	0,5	0	0,00	0,00	0,00
09.07.2017	19,656	20,0	58	0,42	0	0,00	20,98	3,63
10.07.2017	19,907	26,0	60	0,34	0,2	0,00	0,00	10,25
11.07.2017	19,514	24,5	61	0,26	0	0,00	0,00	4,84
12.07.2017	19,137	25,0	56	0,18	0	0,00	40,32	0,00
13.07.2017	18,967	24,9	59	0,1	0	0,00	0,00	27,83
14.07.2017	18,845	25,5	38	0,02	0	0,00	0,00	23,80
15.07.2017	18,919	26,0	49	0	0	0,00	30,30	18,01
16.07.2017	18,722	22,6	45	0	0	0,00	0,00	0,00
17.07.2017	18,558	26,1	43	0	0	0,00	0,00	14,89
18.07.2017	18,470	24,9	53	0	0	0,00	30,17	11,34
19.07.2017	18,512	25,5	49	0	0	0,00	0,00	0,00
20.07.2017	18,367	25,5	48	0	0	0,00	0,00	15,44
21.07.2017	18,487	23,9	55	0	0	0,00	30,10	13,11
22.07.2017	18,416	23,8	56	0	0	0,00	0,00	25,44
23.07.2017	18,368	22,7	55	0	0	0,00	0,00	0,00
24.07.2017	18,225	24,5	61	0	0	0,00	10,21	11,22
25.07.2017	18,136	24,5	64	0	0	0,00	10,40	6,07
26.07.2017	17,884	24,5	63	0	0	0,00	0,00	7,55
27.07.2017	17,631	24,2	62	0	0	0,00	10,06	6,64
28.07.2017	17,562	24,0	66	0	0	0,00	10,61	4,55
29.07.2017	17,451	27,1	55	0	0	0,00	20,17	7,76
30.07.2017	17,221	24,5	60	0	0	0,00	0,00	0,00
31.07.2017	17,108	25,9	62	0	0	0,00	10,51	16,15
01.08.2017	16,906	26,0	59	0	0	0,00	10,20	8,71
02.08.2017	16,899	25,5	68	0	0	0,00	8,10	9,24
03.08.2017	16,772	25,0	51	0	0	0,00	8,16	6,28
04.08.2017	16,518	27,5	53	0	0	0,00	8,89	5,82
05.08.2017	16,455	27,1	44	0	0	0,00	16,11	8,89
06.08.2017	16,413	26,0	49	0	0	0,00	0,00	0,00
07.08.2017	16,356	26,5	53	0	0	0,00	8,03	11,99
08.08.2017	16,294	27,7	39	0	0	0,00	8,06	7,11
09.08.2017	16,122	28,1	40	0	0	0,00	8,10	6,85
10.08.2017	16,026	24,8	67	0	0	0,00	16,11	8,10
11.08.2017	16,007	28,0	50	0	0	0,00	0,00	0,00
12.08.2017	15,890	25,8	63	0	0	0,00	16,29	15,24
13.08.2017	15,793	23,5	56	0	0	0,00	0,00	0,00
14.08.2017	15,771	27,7	45	0	0	0,00	16,12	12,20
15.08.2017	15,560	24,5	56	0	0	0,00	0,00	0,00
16.08.2017	15,571	23,9	76	0	0	0,00	0,00	14,92
17.08.2017	15,634	24,0	70	0	0	0,00	0,00	0,00
18.08.2017	15,672	26,1	69	0	0	0,00	8,33	13,52
19.08.2017	15,606	26,1	62	0	0	0,00	16,40	6,86
20.08.2017	15,574	23,5	56	0	0	0,00	0,00	0,00
21.08.2017	15,403	25,4	55	0	0	0,00	8,60	13,85
22.08.2017	15,266	25,1	56	0	0	0,00	6,11	7,55
23.08.2017	15,143	24,5	55	0	0	0,00	16,27	5,12
24.08.2017	15,056	23,0	54	0	0	0,00	0,00	0,00
25.08.2017	14,993	24,6	51	0	0	0,00	12,50	14,15
26.08.2017	14,852	24,0	52	0	0	0,00	0,00	0,00
27.08.2017	14,803	22,1	56	0	0	0,00	16,25	10,64
28.08.2017	14,745	21,5	61	0	0	0,00	0,00	0,00
29.08.2017	14,634	22,6	56	0	0	0,00	12,33	9,96
30.08.2017	14,552	25,5	50	0	0	0,00	11,98	9,17
31.08.2017	14,780	26,9	46	0	0	31,68	0,00	11,61
01.09.2017	15,209	18,5	76	0	0	31,45	0,00	22,74
02.09.2017	15,660	16,7	79	0	0	71,99	0,00	11,21
03.09.2017	16,344	20,6	64	0	0	0,00	0,00	0,00
04.09.2017	16,893	19,7	76	0	0	34,22	0,00	8,90
05.09.2017	17,209	20,0	58	0	0	37,34	0,00	4,96
06.09.2017	17,679	18,7	74	0	0	30,60	0,00	4,96
07.09.2017	17,905	16,5	74	0	0	30,71	0,00	3,30
08.09.2017	18,106	19,7	65	0	0	31,49	0,00	2,68


Итоги работы:

По графикам и значениям метрик видно, что предсказание не идеальное и его можно улучшить. В результате чего была выполнена попытка добавления нового столбца с данными. Данные были искусственно сгенерированы на основе информации о росте и падении графика. Значение 1 было присвоено, если график рос, и значение 0 - если график падал. Однако, несмотря на «очевидную» подсказку для нейронной сети должен ли график расти или падать, результат обучения стал менее точным после добавления нового столбца с данными.
Результат введения нового столбца с данными показал, что уже имеющихся признаков достаточно для построения корректного решения. И несмотря на настолько маленький датасет для обучения, модель демонстрирует достаточно хорошие результаты в предсказании графика, хотя и не идеальные.

Факторы, влияющие на целевую переменную

Так как построение модели ведется с помощью нейронной сети нельзя точно определить, какие данные оказывают наибольшее влияние на результат обучения. Однако, при помощи графика предсказания значений временного ряда на тренировочных данных можно сделать вывод, что наибольшие проблемы у модели возникают после 13 дня. Сравнивая этот день вручную с датасетом можно обнаружить, что именно в этот день данные для столбца «А» обнуляются. Матрица корреляции подтверждает данное предположение. После 45 дня предсказания также начинают резко ухудшаться, но, к сожалению, в этом месте уже невозможно выявить причину данных ухудшений.

Заключение

В ходе работы был проанализирован данный датасет и построена модель нейронной сети, которая демонстрирует очень хорошие результаты в предсказании временных рядов.
В результате обучения модель показала значения по метрике MAE равное 0.587129 и по метрике MAPE — 3.7243%, что является очень хорошими показателями для прогнозирования временных рядов. Точность предсказаний модели можно было наглядно оценить, сравнивая предсказанные значения с фактическими на графике.
Также была исследована возможность улучшения данных путем добавления дополнительного столбца, однако был сделан вывод, что дополнительный столбец вводить не нужно, поскольку результаты модели достаточно хорошие.
Для достижения лучших результатов моделирования необходимо использовать более крупный датасет и провести обучение на большем количестве данных, чтобы улучшить результаты.
